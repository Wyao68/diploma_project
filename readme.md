# 数据驱动辅助高频电力电子线圈设计

## 设计目标
一个专注于线圈设计的通用化方案，该方案不依赖于WPT系统的具体拓扑，而是通过数据驱动的方法建立线圈的几何参数与电气参数（如自感、电阻、互感等）之间的映射关系。这样的方案可以用于快速评估和优化线圈设计。将机器学习模型作为一个代理模型来替代耗时的有限元仿真。通过用实验数据校正，这个代理模型既保持了快速计算的优势，又提高了预测的真实性。

## 具体思路
### 1.定义输入特征（设计变量）
对于通用线圈设计，考虑以下几何参数和材料参数：
* 线圈形状（平面螺旋、圆柱螺旋）
* 匝数($N$)
* 匝间距($p$)
* 线径($d$)
* 内径($D_{in}$) 或 外径($D_{out}$)
* 线圈高度($h$)（对于圆柱线圈）
* 导线材料（电导率$\sigma$）

### 2.确定输出目标（电气参数）
* 自感($L$)
* 交流电阻($R_{ac}$)（在特定频率下）
* 自谐振频率($SRF$)或寄生电容
* 品质因数($Q$)
* 互感($M$)（当有两个及以上线圈时，还需要考虑相对位置）

### 3.模型选择
由于互感依赖于多个线圈的相对位置，我们可以先建立单个线圈的模型，然后利用诺依曼公式等计算互感，或者将互感作为另一个数据驱动问题（输入为两个线圈的几何参数和相对位置）。

### 4.数据收集
使用有限元仿真进行参数化扫描，结合一些真实实验数据，生成数据集。 

### 5.数据预处理
#### 数据清洗
* 处理缺失值：使用均值、中位数填充
* 处理异常值：通过统计方法（如3$\sigma$原则），对异常数据进行修正或删除
#### 数据归一化，标准化
* 归一化：将数据放缩到一个固定范围，如$[0,1]$或$[-1,1]$ 
* 标准化：将数据放缩为均值为0，标准差为1的分布
#### 数据编码
* 将计算机难以处理的信息格式编码为易于处理的数据格式
#### 数据分割
* 训练集：用于训练模型，调整权重
* 验证集：用于在训练过程中评估模型，进行超参数调优，防止过拟合
* 测试集：用于在训练结束后最终评估模型的泛化性能

### 6.模型训练与验证
#### 两阶段迁移学习： 
* 第一阶段（仿真预训练）：使用全部仿真数据对神经网络进行初步训练，让模型学习到电磁场变化的基础规律。此时，模型可能在仿真数据上表现良好，但用于真实实验数据时存在偏差。
* 第二阶段（实验数据微调）：用少量的实验数据，在预训练模型的基础上继续训练。此时可以使用较小的学习率，避免破坏模型已学到的基础知识，只进行细微调整。引入真实数据能有效提升模型对真实情况的预测精度，减少仿真与实验间的偏差。

### 7.优化设计
将该代理模型与优化算法结合，进行线圈参数的自动优化设计（时间充裕可以尝试）

### 8.理论支持
* **半监督学习**：同时使用大量"带噪"或"有偏"的仿真数据（弱标签）和少量高精度实验数据（强标签）。研究表明，在高维数据场景下，未标记数据（或带噪数据）能有效提升模型的估计精度和鲁棒性。
* **迁移学习**：先在仿真的"源域"学习基础任务，然后将知识迁移到实验的"目标域"。这解决了目标域数据不足的问题。
* **物理信息机器学习**：将已知的物理定律（如电磁场方程）以软约束形式融入神经网络损失函数，能减轻模型对不完美数据的过拟合，提升外推能力和结果的物理合理性。

### 9.一些小tips
相比于面向对象编程，机器学习更适合向量化编程  

### 网络编写重点
* 根据问题选择正确的激活函数
* 权重更新方式
* 梯度检查（梯度误差在一定范围以内可认为通过梯度检查）
* 超参数选取——网络层数、节点数、学习率等(尝试使用贝叶斯优化或其他的成熟工具或算法自动化调节超参数)

### 网络训练重点
* 网络参数量与样本数量不宜相差过多
* 权重初始值会影响最终训练效果(加入随机数，并使用策略进行优化)
* 训练策略选择（如每训练10轮，评估一次准确率。当准确率开始下降时（出现了过拟合）终止训练）
* 使用服务器而不是本地进行训练，否则占用大量本地资源，同时程序运行时间过程，容易出现崩溃等现象致使前功尽弃
* 误差在达到最小值（也可能是局部最小值）后会收敛，即不再继续下降


